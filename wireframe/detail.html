<!doctype html>
<html lang="zh-CN">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>壁纸详情 · Wireframe</title>
    <script>
      // Tailwind Play CDN config
      window.tailwind = {
        config: {
          darkMode: 'class',
          theme: {
            extend: {
              colors: {
                brand: {
                  500: '#3B82F6',
                  600: '#2563EB',
                },
              },
              boxShadow: {
                soft: '0 10px 20px rgba(0,0,0,0.08)',
                softlg: '0 14px 28px rgba(0,0,0,0.12)'
              }
            }
          }
        }
      }
    </script>
    <script>(function(){try{const stored=localStorage.getItem('theme');const prefersDark=window.matchMedia&&window.matchMedia('(prefers-color-scheme: dark)').matches;const html=document.documentElement;if(stored==='dark'||(!stored&&prefersDark)){html.classList.add('dark');}else{html.classList.remove('dark');}}catch(e){}})();</script>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="styles/tokens.css">
    <style>
      body { background: var(--body-bg); }
      html.dark body { background: var(--body-bg); }
      .detail-ph { position: relative; overflow: hidden; background: var(--ph-bg); border-radius: inherit; }
      .detail-ph::before { content: ''; display: block; width: 100%; padding-top: 56.25%; }
      .color-dot { width: 14px; height: 14px; border-radius: 9999px; border: 1px solid var(--border-soft); }
      /* 信息条：与首页统一为黑底白字，白色阴影收敛，延迟精确80ms */
      .info-bar { background-color: rgba(0,0,0,0.60) !important; color: #fff !important; border-color: rgba(255,255,255,0.18) !important; box-shadow: 0 0 5px rgba(255,255,255,0.6); transition: opacity .3s ease .08s, transform .3s ease .08s; }
      /* 立体描边：左/上白（变量），右/下黑（浅色0.18/深色0.28）；2px；圆角继承并更显著 */
      .detail-ph::after { content: ''; position: absolute; inset: 0; pointer-events: none; z-index: 2; box-sizing: border-box; border-top: 2px solid var(--elev-outline-top-left); border-left: 2px solid var(--elev-outline-top-left); border-right: 2px solid var(--elev-outline-bottom-right); border-bottom: 2px solid var(--elev-outline-bottom-right); border-radius: inherit; }
      .detail-ph, .detail-ph::after { border-radius: var(--radius-xl) !important; }
      /* 令牌映射：阴影 */
      .shadow-soft { box-shadow: var(--shadow-soft) !important; }
      .shadow-softlg { box-shadow: var(--shadow-soft-lg) !important; }
      /* 令牌映射：圆角 */
      .rounded-xl { border-radius: var(--radius-lg) !important; }
      .rounded-2xl { border-radius: var(--radius-xl) !important; }
      /* Header：与首页保持一致的 70% 白 + 粗颗粒磨砂（浅色），深色关闭纹理 */
      header { background-color: rgba(255,255,255,0.70) !important; border-color: var(--border-soft) !important; background-image: radial-gradient(rgba(255,255,255,0.24) 1.6px, transparent 1.6px), radial-gradient(rgba(0,0,0,0.06) 1.2px, transparent 1.2px); background-size: 14px 14px, 22px 22px; background-position: 0 0, 9px 9px; background-blend-mode: overlay; }
      html.dark header { background-image: none; background-color: rgba(255,255,255,0.18) !important; }
      /* 深色模式：顶部 Logo 与右上角文字强制白色，提升对比 */
      html.dark header .text-lg, html.dark header a, html.dark header #themeToggle { color: #fff !important; }
      header .rounded-full.border { background-color: var(--surface); border-color: var(--border-soft); color: var(--text-primary); }
      /* 侧栏卡片：底色统一为纯白，文本统一深灰，提高可读性 */
      aside.rounded-2xl { border-color: var(--border-soft) !important; background-color: #ffffff !important; }
      aside.rounded-2xl, aside.rounded-2xl * { color: #111827 !important; }
      /* 推荐卡片容器：维持表层色，但描边统一 */
      section .group.rounded-xl { border-color: var(--border-soft) !important; background-color: var(--surface) !important; }
      /* 下载弹窗：半透明遮罩（保留页面可见），面板保持不透明 */
       #downloadModal .scrim { background: var(--overlay-scrim) !important; }
       /* 保障层级：遮罩在下，内容在上 */
       #downloadModal > .scrim { z-index: 0; }
       #downloadModal > .flex { z-index: 1; }
       /* 弹窗面板背景与页面统一（浅色米白 #F8F8F5 / 深色渐变与页面一致），保持不透明 */
       #downloadModal .rounded-2xl { background: var(--body-bg) !important; border-color: var(--border-soft) !important; }
       #downloadModal .relative { background-color: var(--surface-muted) !important; }
      #previewArea { background-color: var(--surface-muted) !important; }
      #cropBox { box-shadow: 0 0 0 9999px var(--overlay-scrim) !important; }
      #downloadModal select, #downloadModal input { background-color: var(--surface) !important; border-color: var(--border-strong) !important; color: var(--text-primary) !important; }
      #downloadModal .ratio-btn, #applyRatio, #closeDownload { background-color: var(--surface) !important; border-color: var(--border-strong) !important; color: var(--text-primary) !important; }
      /* 页面内其他中性色按钮（非主按钮） */
      main button.rounded-full.border { background-color: var(--surface) !important; border-color: var(--border-strong) !important; color: var(--text-primary) !important; }
      /* 相关推荐："前往"按钮与信息条样式与首页统一 */
      .overlay-bg { background-color: rgba(0,0,0,0.65) !important; border: 1px solid rgba(255,255,255,0.25) !important; }
    </style>
  </head>
  <body class="text-gray-900 dark:text-gray-100 min-h-screen">
    <div id="app" class="min-h-screen flex flex-col">
      <header class="sticky top-0 z-40 border-b backdrop-blur">
        <div class="max-w-6xl mx-auto px-4 py-3 flex items-center justify-between">
          <div class="flex items-center gap-3">
            <a href="index.html" class="px-3 py-1.5 rounded-full border text-sm">← 返回</a>
            <div class="text-lg font-bold">3Dwallpaper</div>
          </div>
          <button id="themeToggle" class="px-3 py-1.5 rounded-full border text-sm">深/浅</button>
        </div>
        <!-- 顶部标签 chips，可点击回首页筛选（携带 tag 参数） -->
        <div class="border-t">
          <div class="max-w-6xl mx-auto px-4 py-2 flex flex-wrap gap-2 text-sm">
            <a href="index.html?tag=风景" class="px-2 py-1 rounded-full border">风景</a>
            <a href="index.html?tag=城市" class="px-2 py-1 rounded-full border">城市</a>
            <a href="index.html?tag=夜景" class="px-2 py-1 rounded-full border">夜景</a>
          </div>
        </div>
      </header>

      <main class="flex-1">
        <div class="max-w-6xl mx-auto px-4 py-6 grid grid-cols-1 lg:grid-cols-2 gap-6 items-start lg:items-center">
          <!-- 左：大图占位 -->
          <figure class="rounded-2xl overflow-hidden">
            <div class="detail-ph rounded-2xl overflow-hidden"></div>
          </figure>

          <!-- 右：信息侧栏 -->
          <aside class="rounded-2xl overflow-hidden shadow-soft border border-black/5 dark:border-white/10 bg-white/80 dark:bg-white/5">
            <div class="p-5 space-y-4">
              <div>
                <h1 class="text-lg font-semibold">壁纸标题（占位）</h1>
                <p class="text-sm opacity-70">作者名（占位）</p>
              </div>

              <!-- 移除这里的标签行，标签已移到页头 chips -->

              <div class="grid grid-cols-2 gap-x-6 gap-y-3 text-sm">
                <div class="opacity-70">分辨率</div><div>3840×2160（4K）</div>
                <div class="opacity-70">图片色系</div>
                <div class="flex items-center gap-2">
                  <span class="color-dot" style="background:#0ea5e9"></span>
                  <span class="color-dot" style="background:#1d4ed8"></span>
                  <span class="color-dot" style="background:#475569"></span>
                </div>
                <div class="opacity-70">文件大小</div><div>2.4 MB</div>
                <div class="opacity-70">下载量</div><div>350</div>
                <div class="opacity-70">收藏量</div><div>120</div>
                <div class="opacity-70">更新时间</div><div>2025-02-02</div>
              </div>

              <div class="pt-2 flex items-center gap-3">
                <button id="openDownload" class="px-4 py-2 rounded-full border text-sm">下载</button>
                <button class="px-4 py-2 rounded-full border text-sm">★ 收藏</button>
              </div>
            </div>
          </aside>
        </div>
        <!-- 相关推荐：移入 main 内，紧随展示图与侧栏之后 -->
        <section class="max-w-6xl mx-auto px-4 mt-4 pb-8">
          <h2 class="text-base font-semibold mb-3">相关推荐</h2>
          <div class="grid grid-cols-2 sm:grid-cols-3 lg:grid-cols-4 gap-4 sm:gap-5">
            <!-- 卡片1 -->
            <a href="detail.html" class="group rounded-xl overflow-hidden shadow-soft border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 block">
              <div class="relative detail-ph">
                <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                  <span class="pointer-events-auto w-12 h-12 rounded-full overlay-bg text-white text-xs backdrop-blur transition-opacity duration-200 opacity-0 group-hover:opacity-100 flex items-center justify-center">前往</span>
                </div>
                <div class="absolute inset-x-0 bottom-0 p-2">
                  <div class="info-bar mx-2 mb-1 rounded overlay-bg text-white text-[11px] px-2.5 py-1.5 flex items-center justify-between opacity-0 translate-y-2 transition-all duration-300 backdrop-blur-sm group-hover:opacity-100 group-hover:translate-y-0">
                    <div class="flex items-center gap-1.5 flex-wrap pr-2"><span class="px-1.5 py-0.5 rounded border">风景</span></div>
                    <span class="whitespace-nowrap">★ 80 · ⬇ 120</span>
                  </div>
                </div>
              </div>
            </a>
            <!-- 卡片2 -->
            <a href="detail.html" class="group rounded-xl overflow-hidden shadow-soft border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 block">
              <div class="relative detail-ph">
                <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                  <span class="pointer-events-auto w-12 h-12 rounded-full overlay-bg text-white text-xs backdrop-blur transition-opacity duration-200 opacity-0 group-hover:opacity-100 flex items-center justify-center">前往</span>
                </div>
                <div class="absolute inset-x-0 bottom-0 p-2">
                  <div class="info-bar mx-2 mb-1 rounded overlay-bg text-white text-[11px] px-2.5 py-1.5 flex items-center justify-between opacity-0 translate-y-2 transition-all duration-300 backdrop-blur-sm group-hover:opacity-100 group-hover:translate-y-0">
                    <div class="flex items-center gap-1.5 flex-wrap pr-2"><span class="px-1.5 py-0.5 rounded border">城市</span></div>
                    <span class="whitespace-nowrap">★ 66 · ⬇ 98</span>
                  </div>
                </div>
              </div>
            </a>
            <!-- 卡片3 -->
            <a href="detail.html" class="group rounded-xl overflow-hidden shadow-soft border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 block">
              <div class="relative detail-ph">
                <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                  <span class="pointer-events-auto w-12 h-12 rounded-full overlay-bg text-white text-xs backdrop-blur transition-opacity duration-200 opacity-0 group-hover:opacity-100 flex items-center justify-center">前往</span>
                </div>
                <div class="absolute inset-x-0 bottom-0 p-2">
                  <div class="info-bar mx-2 mb-1 rounded overlay-bg text-white text-[11px] px-2.5 py-1.5 flex items-center justify-between opacity-0 translate-y-2 transition-all duration-300 backdrop-blur-sm group-hover:opacity-100 group-hover:translate-y-0">
                    <div class="flex items-center gap-1.5 flex-wrap pr-2"><span class="px-1.5 py-0.5 rounded border">夜景</span></div>
                    <span class="whitespace-nowrap">★ 102 · ⬇ 210</span>
                  </div>
                </div>
              </div>
            </a>
            <!-- 卡片4 -->
            <a href="detail.html" class="group rounded-xl overflow-hidden shadow-soft border border-black/5 dark:border-white/10 bg-white/70 dark:bg-white/5 block">
              <div class="relative detail-ph">
                <div class="absolute inset-0 flex items-center justify-center pointer-events-none">
                  <span class="pointer-events-auto w-12 h-12 rounded-full overlay-bg text-white text-xs backdrop-blur transition-opacity duration-200 opacity-0 group-hover:opacity-100 flex items-center justify-center">前往</span>
                </div>
                <div class="absolute inset-x-0 bottom-0 p-2">
                  <div class="info-bar mx-2 mb-1 rounded overlay-bg text-white text-[11px] px-2.5 py-1.5 flex items-center justify-between opacity-0 translate-y-2 transition-all duration-300 backdrop-blur-sm group-hover:opacity-100 group-hover:translate-y-0">
                    <div class="flex items-center gap-1.5 flex-wrap pr-2"><span class="px-1.5 py-0.5 rounded border">自然</span></div>
                    <span class="whitespace-nowrap">★ 45 · ⬇ 88</span>
                  </div>
                </div>
              </div>
            </a>
          </div>
        </section>
      </main>

      <footer class="max-w-6xl mx-auto px-4 py-8 text-xs opacity-70">
        © 2025 3Dwallpaper · 线框演示。图片版权归原作者所有。
      </footer>
    </div>

    <!-- 下载弹窗：左图右面板（线框实现裁剪比例/拖动） -->
    <div id="downloadModal" class="fixed inset-0 z-[60] hidden">
      <div class="absolute inset-0 scrim"></div>
      <div class="absolute inset-0 flex items-center justify-center p-4">
        <div class="w-full max-w-5xl rounded-2xl overflow-hidden shadow-soft border border-black/10 dark:border-white/10 grid grid-cols-1 lg:grid-cols-2">
          <!-- 左：图片预览与裁剪框 -->
          <div class="relative">
            <div id="previewArea" class="relative m-4 rounded-lg overflow-hidden" style="height: min(60vh, 520px);">
              <div class="absolute inset-0 flex items-center justify-center text-xs opacity-70 select-none">图片预览（占位）</div>
              <div id="cropBox" class="absolute border-2 border-brand-600/90 cursor-move"></div>
            </div>
          </div>
          <!-- 右：操作面板 -->
          <div class="p-4 lg:p-6 space-y-4">
            <div class="flex items-center justify-between">
              <h3 class="text-base font-semibold">下载设置</h3>
              <button id="closeDownload" class="px-2 py-1 text-sm rounded border">关闭</button>
            </div>
            <div class="space-y-3 text-sm">
              <div>
                <div class="opacity-70 mb-1">分辨率</div>
                <select id="resolution" class="w-full rounded border px-2 py-1">
                  <option value="orig">原图</option>
                  <option value="3840x2160">4K · 3840×2160</option>
                  <option value="2560x1440">2K · 2560×1440</option>
                  <option value="1920x1080">1080p · 1920×1080</option>
                </select>
              </div>
              <div>
                <div class="opacity-70 mb-1">快捷选择比例</div>
                <div class="flex flex-wrap gap-2">
                  <button data-ratio="orig" class="ratio-btn px-2 py-1 rounded-full border text-xs">原图比例</button>
                  <button data-ratio="3:2" class="ratio-btn px-2 py-1 rounded-full border text-xs">3:2</button>
                  <button data-ratio="4:3" class="ratio-btn px-2 py-1 rounded-full border text-xs">4:3</button>
                  <button data-ratio="5:4" class="ratio-btn px-2 py-1 rounded-full border text-xs">5:4</button>
                  <button data-ratio="7:3" class="ratio-btn px-2 py-1 rounded-full border text-xs">7:3</button>
                  <button data-ratio="7:5" class="ratio-btn px-2 py-1 rounded-full border text-xs">7:5</button>
                  <button data-ratio="16:9" class="ratio-btn px-2 py-1 rounded-full border text-xs">16:9</button>
                </div>
              </div>
              <div>
                <div class="opacity-70 mb-1">手动输入比例</div>
                <div class="flex items-center gap-2">
                  <input id="ratioW" type="number" min="1" value="16" class="w-20 px-2 py-1 rounded border" />
                  <span>:</span>
                  <input id="ratioH" type="number" min="1" value="9" class="w-20 px-2 py-1 rounded border" />
                  <button id="applyRatio" class="px-3 py-1 rounded-full border text-xs">应用</button>
                </div>
              </div>
            </div>
            <div class="pt-2">
              <button id="saveImage" class="w-full px-4 py-2 rounded-full bg-brand-600 hover:bg-brand-500 text-white text-sm shadow-soft">保存图片</button>
            </div>
          </div>
        </div>
      </div>
    </div>

    <script>
      const themeBtn = document.getElementById('themeToggle');
      const html = document.documentElement;
      if (themeBtn) themeBtn.addEventListener('click', () => { html.classList.toggle('dark'); try{localStorage.setItem('theme', html.classList.contains('dark') ? 'dark' : 'light');}catch(e){} });

      // 下载弹窗交互与裁剪框
      const openBtn = document.getElementById('openDownload');
      const closeBtn = document.getElementById('closeDownload');
      const modal = document.getElementById('downloadModal');
      const overlay = modal.querySelector('.scrim');
      const preview = document.getElementById('previewArea');
      const crop = document.getElementById('cropBox');
      const ratioBtns = Array.from(document.querySelectorAll('.ratio-btn'));
      const applyRatio = document.getElementById('applyRatio');
      const ratioW = document.getElementById('ratioW');
      const ratioH = document.getElementById('ratioH');

      let ratio = 16/9; // 默认

      function openModal(){ modal.classList.remove('hidden'); setTimeout(fitCropBox, 0); }
      function closeModal(){ modal.classList.add('hidden'); }
      openBtn && openBtn.addEventListener('click', openModal);
      closeBtn && closeBtn.addEventListener('click', closeModal);
      overlay && overlay.addEventListener('click', closeModal);

      function fitCropBox(){
        const rect = preview.getBoundingClientRect();
        const maxW = rect.width - 16; // 边距
        const maxH = rect.height - 16;
        let w = maxW, h = w / ratio;
        if (h > maxH) { h = maxH; w = h * ratio; }
        crop.style.width = w + 'px';
        crop.style.height = h + 'px';
        crop.style.left = (rect.width - w)/2 + 'px';
        crop.style.top = (rect.height - h)/2 + 'px';
      }

      // 仅回中，不改变当前裁剪框尺寸
      function centerCropBox(){
        const rect = preview.getBoundingClientRect();
        const w = crop.offsetWidth; const h = crop.offsetHeight;
        const l = Math.max(0, (rect.width - w)/2);
        const t = Math.max(0, (rect.height - h)/2);
        crop.style.left = l + 'px';
        crop.style.top = t + 'px';
      }

      function setRatioByString(s){
        if (s === 'orig') { ratio = 16/9; } // 线框：以16:9代指原图比例
        else {
          const [rw, rh] = s.split(':').map(Number);
          if (rw > 0 && rh > 0) ratio = rw / rh;
        }
        fitCropBox();
      }

      ratioBtns.forEach(b=>{
        b.addEventListener('click', ()=> setRatioByString(b.dataset.ratio));
      });
      applyRatio && applyRatio.addEventListener('click', ()=>{
        const w = parseFloat(ratioW.value); const h = parseFloat(ratioH.value);
        if (w > 0 && h > 0) { ratio = w/h; fitCropBox(); }
      });
      window.addEventListener('resize', ()=>{ if (!modal.classList.contains('hidden')) fitCropBox(); });

      // 拖动裁剪框
      let dragging = false, startX=0, startY=0, startLeft=0, startTop=0;
      crop.addEventListener('mousedown', (e)=>{
        dragging = true; startX = e.clientX; startY = e.clientY;
        const cs = getComputedStyle(crop);
        startLeft = parseFloat(cs.left); startTop = parseFloat(cs.top);
        e.preventDefault();
      });
      window.addEventListener('mousemove', (e)=>{
        if (!dragging) return;
        const dx = e.clientX - startX; const dy = e.clientY - startY;
        const rect = preview.getBoundingClientRect();
        const cw = crop.offsetWidth; const ch = crop.offsetHeight;
        let nl = startLeft + dx; let nt = startTop + dy;
        nl = Math.max(0, Math.min(rect.width - cw, nl));
        nt = Math.max(0, Math.min(rect.height - ch, nt));
        crop.style.left = nl + 'px'; crop.style.top = nt + 'px';
      });
      window.addEventListener('mouseup', ()=> dragging = false);

      // 双击裁剪框回中
      crop.addEventListener('dblclick', centerCropBox);

      // 保存（线框：仅打印参数）
      const saveBtn = document.getElementById('saveImage');
      saveBtn && saveBtn.addEventListener('click', ()=>{
        const r = document.getElementById('resolution').value;
        const rect = preview.getBoundingClientRect();
        const x = parseFloat(crop.style.left)||0; const y = parseFloat(crop.style.top)||0;
        const w = crop.offsetWidth; const h = crop.offsetHeight;
        console.log('保存图片：', { 分辨率: r, 裁剪: { x, y, w, h }, 预览区域: { width: rect.width, height: rect.height } });
        alert('已按所选分辨率与裁剪框生成下载（线框演示）');
        closeModal();
      });
    </script>


  </body>
</html>

       /* 深色模式下：详情页主按钮（下载/收藏）提升边框与文字对比度 */
       html.dark #openDownload, html.dark main button.rounded-full.border { border-color: rgba(255,255,255,0.35) !important; color: rgba(255,255,255,0.95) !important; }