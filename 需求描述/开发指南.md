# 3Dwallpaper · 开发指南（Wireframe 版）

本文记录当前线框项目的所有已落地设计与实现方法，便于未来用任意 AI 编程工具快速复刻本项目。

---

## 1. 项目概览
- 类型：纯前端静态站点（首页 + 详情页），无构建步骤，直接通过浏览器访问。
- 技术：原生 HTML/CSS/JS + Tailwind CSS（CDN 版）。
- 目标：
  - 提供稳定的浅/深色主题切换，跨页面保持且避免闪烁。
  - 统一的占位背景体系，便于多页面复用与主题适配。
  - 清晰的页面结构与可扩展的样式令牌（CSS 变量）。

## 2. 目录结构
```
/bizhi
├─ /wireframe
│  ├─ index.html   # 首页
│  ├─ detail.html  # 详情页
│  └─ /styles
│     └─ tokens.css  # 跨页面样式令牌（CSS 变量）
└─ /需求描述
   ├─ 开发指南.md
   └─ 裸眼3D壁纸_需求文档_V1.0.md
```

## 3. 本地运行
无需安装依赖，直接开启静态服务器：
- Windows（已用于本项目）：
  - 命令：python -m http.server 5500 --bind 127.0.0.1 --directory "d:\trea_project\bizhi\wireframe"
  - 访问：http://127.0.0.1:5500/index.html 与 http://127.0.0.1:5500/detail.html

## 4. 设计与实现基线
### 4.1 Tailwind 与主题模式
- 使用 Tailwind CDN，开启暗色模式为 class 策略：`darkMode: 'class'`。
- 主题初始化脚本必须置于 Tailwind CDN 脚本之前，以避免页面初次渲染闪烁：
  1) 读取 localStorage 的用户选择（'dark'/'light'）；
  2) 若无显式选择，则回退到系统偏好 `prefers-color-scheme`；
  3) 在 `<html>` 节点添加或移除 `dark` 类；
  4) 再加载 Tailwind CDN（使其按最终类名计算暗色样式）。
- 主题按钮点击时，切换 `<html>` 的 `dark` 类并把选择写入 localStorage，实现跨页面保持。

### 4.2 占位背景变量（跨页面统一）
- 令牌集中在 `wireframe/styles/tokens.css` 中进行根作用域声明；每个页面在 `<head>` 通过 `<link rel="stylesheet" href="styles/tokens.css">` 引入，避免重复与偏差。
  - 浅色：`rgba(229,231,235,0.70)`（Tailwind slate-200 的 70% 近似）
  - 深色：`rgba(255,255,255,0.10)`
- 使用规范：任何占位元素均不再使用 Tailwind 的背景色工具类（如 `bg-gray-200/70` 或 `dark:bg-…`），统一通过 `background: var(--ph-bg)` 赋值。

### 4.3 页面比例占位与高光描边
- 比例占位：使用 `::before` 在容器内部创建 16:9 占位（`padding-top: 56.25%`）。
- 高光描边：在详情页与相关推荐卡片的占位容器上，用 `::after` 添加左/上浅色描边与右/下暗色描边，深色模式下提高对比度，增强浮起感。

---

## 5. 页面实现
### 5.1 首页（wireframe/index.html）
- 头部：
  - 左侧品牌/返回，右侧主题切换按钮（点击写入 localStorage）。
  - 顶部 chips 作为标签入口（示例：风景/城市/夜景），用于回首页带参数筛选（线框占位）。
- 卡片网格：
  - 占位元素类名为 `ph`，统一样式：
    - `#grid .ph { background: var(--ph-bg); position: relative; overflow: hidden; transition: transform/box-shadow; border-radius: inherit; }`
  - 移除了卡片模板内的 Tailwind 背景类（如 `bg-gray-200/70` 和 `dark:bg-white/10`），避免与变量冲突。
  - 悬停信息条 `.info-bar` 提供轻微的白色柔光阴影与过渡以增强可见性。

### 5.2 详情页（wireframe/detail.html）
- 布局：左侧大图占位，右侧信息面板（参数、色点、下载与收藏）。
- 主题一致：采用与首页相同的主题初始化脚本与按钮逻辑。
- 占位容器：
  - 类名 `.detail-ph`，使用 `background: var(--ph-bg)`；
  - `::before` 16:9 比例占位；
  - `::after` 高光描边，深色模式加大对比；
  - 已去除历史的硬编码背景 `rgba(148,163,184,0.7)` 与重复的 `<style>` 片段。
- 相关推荐：卡片占位也复用 `.detail-ph`，确保与大图背景一致。
- 下载弹窗（线框交互）：包含裁剪比例快捷键与拖动裁剪框，当前仅打印参数（演示）。

---

## 6. 关键代码片段（可直接复刻）
> 放置位置以 `<head>` 中为例，确保执行顺序与说明一致。

1) Tailwind 配置与主题初始化（顺序重要：先 config，再初始化脚本，最后引入 CDN）
```html
<script>
  window.tailwind = {
    config: {
      darkMode: 'class',
      theme: {
        extend: {
          colors: { brand: { 500: '#3B82F6', 600: '#2563EB' } },
          boxShadow: { soft: '0 10px 20px rgba(0,0,0,0.08)', softlg: '0 14px 28px rgba(0,0,0,0.12)' }
        }
      }
    }
  }
</script>
<script>(function(){
  try{
    const stored = localStorage.getItem('theme');
    const prefersDark = window.matchMedia && window.matchMedia('(prefers-color-scheme: dark)').matches;
    const html = document.documentElement;
    if (stored === 'dark' || (!stored && prefersDark)) html.classList.add('dark');
    else html.classList.remove('dark');
  }catch(e){}
})();</script>
<script src="https://cdn.tailwindcss.com"></script>
```

2) 令牌引入与示例
- 在 HTML `<head>` 引入（两页均相同）：
```html
<link rel="stylesheet" href="styles/tokens.css">
```
- `tokens.css` 示例：
```css
:root { --ph-bg: rgba(229,231,235,0.70); }
html.dark { --ph-bg: rgba(255,255,255,0.10); }
```

3) 首页占位统一（示例）
```css
#grid .ph { background: var(--ph-bg); }
```

4) 详情页占位与比例/描边（示例）
```css
.detail-ph { position: relative; overflow: hidden; background: var(--ph-bg); border-radius: inherit; }
.detail-ph::before { content: ''; display: block; width: 100%; padding-top: 56.25%; }
.detail-ph::after { content: ''; position: absolute; inset: 0; pointer-events: none; z-index: 2; box-sizing: border-box; border-top: 2px solid rgba(255,255,255,1); border-left: 2px solid rgba(255,255,255,1); border-right: 2px solid rgba(0,0,0,0.18); border-bottom: 2px solid rgba(0,0,0,0.18); border-radius: inherit; }
html.dark .detail-ph::after { border-top-color: rgba(255,255,255,0.90); border-left-color: rgba(255,255,255,0.90); border-right-color: rgba(0,0,0,0.28); border-bottom-color: rgba(0,0,0,0.28); }
```

5) 主题切换按钮逻辑（跨页保持）
```js
const themeBtn = document.getElementById('themeToggle');
const html = document.documentElement;
if (themeBtn) themeBtn.addEventListener('click', () => {
  html.classList.toggle('dark');
  try { localStorage.setItem('theme', html.classList.contains('dark') ? 'dark' : 'light'); } catch(e) {}
});
```

---

## 7. 扩展与复用约定
- 新增页面：
  - 在 `<head>` 复制「Tailwind 配置 + 主题初始化 + CDN」与「占位背景变量」。
  - 占位元素统一使用 `background: var(--ph-bg)`，不要再叠加背景色工具类。
- 可扩展的样式令牌：如需 Hover/Active 等状态，可新增 `--ph-bg-hover` 等变量，在根作用域与 `html.dark` 中分别赋值，再在组件中 `background: var(--ph-bg-hover)` 使用。
- 性能与稳定性：尽量减少首屏阻塞脚本；主题初始化务必在 Tailwind 之前执行以避免闪烁。

## 8. 验收清单（手动）
- [ ] 首页与详情页在浅/深色下占位背景一致。
- [ ] 刷新或跨页后主题保持不变，无闪烁。
- [ ] 新增占位元素只需类名/选择器覆盖 `background: var(--ph-bg)` 即可无缝适配。

---

如需将色值进一步语义化（如 `--color-surface-muted`）、或抽到独立 CSS 文件集中管理，可在后续版本中增量调整。

## 9. 变更记录 / 版本号
- v0.2.0（2025-09-19）
  - 抽离 CSS 令牌至 `wireframe/styles/tokens.css`，并在 `index.html` 与 `detail.html` 统一引入。
  - 移除两页 `<style>` 中的内联 `:root/html.dark --ph-bg` 定义，改为外部令牌。
  - 使用 `open_preview` 验证浅/深模式下占位背景一致，预览通过。
  - 本开发指南同步更新目录结构、4.2 小节与关键代码片段。
- v0.1.0（初始提交）
  - 搭建首页/详情页线框，完成主题切换与占位背景统一（内联变量版本）。